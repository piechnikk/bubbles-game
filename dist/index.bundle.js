(()=>{"use strict";function t(t,e,i){var n=i.value;i.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.selected&&document.getElementsByTagName("audio")[0].play(),n.apply(this,t)}}function e(t,e,n){var s=n.value;n.value=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return setTimeout((function(){i.speechElement.text=t.points,i.synth.speak(i.speechElement)}),200),s.apply(this,e)}}var i={speechElement:new SpeechSynthesisUtterance,synth:window.speechSynthesis,voices:[],populteVoiceList:function(){if(i.voices=i.synth.getVoices(),console.log(i.voices),0!=i.voices.length)for(var t=0;t<i.voices.length;t++)"en-US"==i.voices[t].lang&&(i.speechElement.voice=i.voices[t])}};i.populteVoiceList(),void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=i.populteVoiceList);const n=function(){function e(t,e,i){this.position=t,this.color=e,this.clickedOnBubble=i,this.create()}return e.prototype.create=function(){var t=this;this.selected=!1,this.div=document.createElement("div"),this.div.classList.add("bubbles"),this.div.style.backgroundColor=this.color,this.div.style.width=.5*o.SIZE+"px",this.div.style.height=.5*o.SIZE+"px",this.div.addEventListener("click",(function(){return t.click()})),document.getElementById(this.position.y+"_"+this.position.x).appendChild(this.div)},e.prototype.click=function(){0!=this.position.x&&0==o.aTab[this.position.y][this.position.x-1]||0!=this.position.y&&0==o.aTab[this.position.y-1][this.position.x]||this.position.x!=o.ROWS-1&&0==o.aTab[this.position.y][this.position.x+1]||this.position.y!=o.COLUMNS-1&&0==o.aTab[this.position.y+1][this.position.x]?(this.changeClick(),this.clickedOnBubble(this)):console.log("blok")},e.prototype.changeClick=function(){this.selected=!this.selected,this.selected?(this.div.style.width=.7*o.SIZE+"px",this.div.style.height=.7*o.SIZE+"px"):(this.div.style.width=.5*o.SIZE+"px",this.div.style.height=.5*o.SIZE+"px")},e.prototype.move=function(t){this.position.x=t.x,this.position.y=t.y,this.changeClick()},e.prototype.remove=function(){document.getElementById(this.position.y+"_"+this.position.x).removeChild(this.div)},function(t,e,i,n){var s,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(o<3?s(a):o>3?s(e,i,a):s(e,i))||a);o>3&&a&&Object.defineProperty(e,i,a)}([t],e.prototype,"click",null),e}();var s=function(t,e,i){if(i||2===arguments.length)for(var n,s=0,o=e.length;s<o;s++)!n&&s in e||(n||(n=Array.prototype.slice.call(e,0,s)),n[s]=e[s]);return t.concat(n||Array.prototype.slice.call(e))};const o=function(){function t(){this.nextBubbles=[],this.points=0,this.createTables(),this.createBoard(),this.addBubbles()}return t.prototype.createTables=function(){t.aTab=[],this.bTab=[],this.bubblesTab=[],this.selectedBubble=null,this.meta={x:null,y:null},this.status=0;for(var e=0;e<t.ROWS;e++){t.aTab.push([]),this.bTab.push([]);for(var i=0;i<t.COLUMNS;i++)t.aTab[e].push(0),this.bTab[e].push([])}},t.prototype.createBoard=function(){for(var e=this,i=document.getElementById("preview"),n=0;n<t.NEW_BALLS_COUNT;n++){var s=document.createElement("div");s.classList.add("bubbles"),s.style.width=.7*t.SIZE+"px",s.style.height=.7*t.SIZE+"px",this.nextBubbles.push(s),i.appendChild(s)}var o=document.getElementById("content");o.innerHTML="",this.table=document.createElement("div"),this.table.id="table",this.table.style.width=t.COLUMNS*t.SIZE+"px";for(var a=function(i){for(var n=function(n){var s=document.createElement("div");s.id=i+"_"+n,s.style.width=t.SIZE+"px",s.style.height=t.SIZE+"px",s.classList.add("cells"),s.addEventListener("click",(function(){3!=e.status||e.selectedBubble.position.x==n&&e.selectedBubble.position.y==i?e.rendere():e.moveBubble()})),s.addEventListener("mouseover",(function(){0!=e.status&&2!=e.status&&Number.isInteger(t.aTab[i][n])&&(t.aTab[i][n]="M",e.meta.x=n,e.meta.y=i,e.status=2,e.startSearching(),e.rendere())})),l.table.appendChild(s)},s=0;s<t.COLUMNS;s++)n(s)},l=this,r=0;r<t.ROWS;r++)a(r);o.appendChild(this.table)},t.prototype.startSearching=function(){this.findShortestRoute([{x:this.selectedBubble.position.x,y:this.selectedBubble.position.y}],1)},t.prototype.moveBubble=function(){var e=this;t.aTab[this.selectedBubble.position.y][this.selectedBubble.position.x]=0,t.aTab[this.meta.y][this.meta.x]=this.selectedBubble.color,document.getElementById(this.selectedBubble.position.y+"_"+this.selectedBubble.position.x).innerHTML="",this.selectedBubble.move(this.meta),document.getElementById(this.selectedBubble.position.y+"_"+this.selectedBubble.position.x).appendChild(this.selectedBubble.div),this.status=0,this.selectedBubble=null;for(var i=0;i<t.ROWS;i++)for(var n=0;n<t.COLUMNS;n++){var s=document.getElementById(i+"_"+n);"red"==s.style.backgroundColor&&(s.style.backgroundColor="gray")}setTimeout((function(){e.rendere(),e.deleteBubbles()&&e.addBubbles(),e.rendere()}),500)},t.prototype.deleteBubbles=function(){for(var e=[],i=function(i){for(var n=null,s=0,o=function(o){if(n=t.aTab[i][o],0==t.aTab[i][o]||null!=n&&t.aTab[i][o]!=n?s=0:s++,o+1>=t.COLUMNS||t.aTab[i][o+1]!=n){if(s>=t.DEL_COUNT)for(var a=function(t){-1==e.findIndex((function(e){return e.x==o-t&&e.y==i}))&&e.push({x:o-t,y:i})},l=0;l<s;l++)a(l);s=0}},a=0;a<t.COLUMNS;a++)o(a)},n=0;n<t.ROWS;n++)i(n);for(var s=function(i){for(var n=null,s=0,o=function(o){if(n=t.aTab[o][i],0==t.aTab[o][i]||null!=n&&t.aTab[o][i]!=n?s=0:s++,o+1>=t.ROWS||t.aTab[o+1][i]!=n){if(s>=t.DEL_COUNT)for(var a=function(t){-1==e.findIndex((function(e){return e.x==i&&e.y==o-t}))&&e.push({x:i,y:o-t})},l=0;l<s;l++)a(l);s=0}},a=0;a<t.ROWS;a++)o(a)},o=0;o<t.COLUMNS;o++)s(o);var a=function(i){for(var n=null,s=0,o=function(o){if(n=t.aTab[o][i+o],0==t.aTab[o][i+o]||null!=n&&t.aTab[o][i+o]!=n?s=0:s++,o+1>=Math.min(t.ROWS,t.COLUMNS)||t.aTab[o+1][i+o+1]!=n){if(s>=t.DEL_COUNT)for(var a=function(t){-1==e.findIndex((function(e){return e.x==i+o-t&&e.y==o-t}))&&e.push({x:i+o-t,y:o-t})},l=0;l<s;l++)a(l);s=0}},a=0;a<Math.min(t.ROWS,t.COLUMNS-i);a++)o(a)};for(o=0;o<t.COLUMNS-(t.DEL_COUNT-1);o++)a(o);var l=function(i){for(var n=null,s=0,o=function(o){if(n=t.aTab[t.ROWS-1-o][i+o],0==t.aTab[t.ROWS-1-o][i+o]||null!=n&&t.aTab[t.ROWS-1-o][i+o]!=n?s=0:s++,o+1>=Math.min(t.ROWS,t.COLUMNS)||t.aTab[t.ROWS-1-o-1][i+o+1]!=n){if(s>=t.DEL_COUNT)for(var a=function(n){-1==e.findIndex((function(e){return e.x==i+o-n&&e.y==t.ROWS-1-o+n}))&&e.push({x:i+o-n,y:t.ROWS-1-o+n})},l=0;l<s;l++)a(l);s=0}},a=0;a<Math.min(t.ROWS,t.COLUMNS-i);a++)o(a)};for(o=0;o<t.COLUMNS-(t.DEL_COUNT-1);o++)l(o);var r=function(i){for(var n=null,s=0,o=function(o){if(n=t.aTab[i-o][o],0==t.aTab[i-o][o]||null!=n&&t.aTab[i-o][o]!=n?s=0:s++,o+1>=Math.min(t.ROWS,t.COLUMNS,i+1)||t.aTab[i-o-1][o+1]!=n){if(s>=t.DEL_COUNT)for(var a=function(t){-1==e.findIndex((function(e){return e.x==o-t&&e.y==i-o+t}))&&e.push({x:o-t,y:i-o+t})},l=0;l<s;l++)a(l);s=0}},a=0;a<Math.min(i+1,t.COLUMNS);a++)o(a)};for(n=t.DEL_COUNT-1;n<t.ROWS;n++)r(n);var h=function(i){for(var n=null,s=0,o=function(o){if(n=t.aTab[i+o][o],0==t.aTab[i+o][o]||null!=n&&t.aTab[i+o][o]!=n?s=0:s++,o+1>=Math.min(t.ROWS,t.COLUMNS,t.ROWS-i)||t.aTab[i+o+1][o+1]!=n){if(s>=t.DEL_COUNT)for(var a=function(t){-1==e.findIndex((function(e){return e.x==o-t&&e.y==i+o-t}))&&e.push({x:o-t,y:i+o-t})},l=0;l<s;l++)a(l);s=0}},a=0;a<Math.min(t.ROWS-i,t.COLUMNS);a++)o(a)};for(n=0;n<t.ROWS-(t.DEL_COUNT-1);n++)h(n);for(var b=function(i){t.aTab[e[i].y][e[i].x]=0;var n=u.bubblesTab.findIndex((function(t){return t.position.x==e[i].x&&t.position.y==e[i].y}));u.bubblesTab[n].remove(),u.bubblesTab.splice(n,1)},u=this,c=0;c<e.length;c++)b(c);return this.points+=e.length,document.getElementById("points").innerText=this.points.toString(),!(e.length>0)},t.prototype.rendere=function(){for(var e=0;e<t.ROWS;e++)for(var i=0;i<t.COLUMNS;i++)document.getElementById(e+"_"+i).style.backgroundColor="";for(null!=this.meta.x&&null!=this.meta.y&&(this.bTab[this.meta.y][this.meta.x].forEach((function(t){document.getElementById(t).style.backgroundColor="red"})),0!=this.bTab[this.meta.y][this.meta.x].length&&(document.getElementById(this.meta.y+"_"+this.meta.x).style.backgroundColor="red")),e=0;e<t.ROWS;e++)for(i=0;i<t.COLUMNS;i++)("M"==t.aTab[e][i]||Number.isInteger(t.aTab[e][i]))&&(t.aTab[e][i]=0,this.bTab[e][i]=[])},t.prototype.addBubbles=function(){var e=this;if(this.bubblesTab.length+t.NEW_BALLS_COUNT>=t.COLUMNS*t.ROWS)window.alert("Koniec gry! Tw√≥j wynik: "+this.points.toString()),window.location.reload();else{if(0==this.bubblesTab.length&&0==this.points){this.nextBubblesColors=[];for(var i=0;i<t.NEW_BALLS_COUNT;i++){var s=Math.floor(Math.random()*t.BALLS_COLOR_TAB.length);this.nextBubblesColors.push(t.BALLS_COLOR_TAB[s])}}var o=function(i){var s,o=void 0;do{o=!1,s={x:Math.floor(Math.random()*t.COLUMNS),y:Math.floor(Math.random()*t.ROWS)},-1!=a.bubblesTab.findIndex((function(t){return t.position.x==s.x&&t.position.y==s.y}))&&(o=!0)}while(o);var l=a.nextBubblesColors[i];t.aTab[s.y][s.x]=l,a.bubblesTab.push(new n(s,l,(function(t){return e.clickedOnBubble(t)})))},a=this;for(i=0;i<t.NEW_BALLS_COUNT;i++)o(i);for(this.nextBubblesColors=[],i=0;i<t.NEW_BALLS_COUNT;i++)s=Math.floor(Math.random()*t.BALLS_COLOR_TAB.length),this.nextBubblesColors.push(t.BALLS_COLOR_TAB[s]);for(i=0;i<this.nextBubbles.length;i++)this.nextBubbles[i].style.backgroundColor=this.nextBubblesColors[i]}},t.prototype.clickedOnBubble=function(t){t.selected?(null!=this.selectedBubble&&this.selectedBubble.changeClick(),this.selectedBubble=t,this.status=1):(this.selectedBubble=null,this.status=0)},t.prototype.findShortestRoute=function(e,i){for(var n=!0,o=[],a=0;a<e.length;a++){var l=e[a];l.x-1>=0&&(0==t.aTab[l.y][l.x-1]?(t.aTab[l.y][l.x-1]=i,this.bTab[l.y][l.x-1]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1),o.push({x:l.x-1,y:l.y}),n=!1):"M"==t.aTab[l.y][l.x-1]&&(0==this.bTab[l.y][l.x-1].length&&(this.bTab[l.y][l.x-1]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1)),this.status=3)),l.y-1>=0&&(0==t.aTab[l.y-1][l.x]?(t.aTab[l.y-1][l.x]=i,this.bTab[l.y-1][l.x]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1),o.push({x:l.x,y:l.y-1}),n=!1):"M"==t.aTab[l.y-1][l.x]&&(0==this.bTab[l.y-1][l.x].length&&(this.bTab[l.y-1][l.x]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1)),this.status=3)),l.x+1<t.COLUMNS&&(0==t.aTab[l.y][l.x+1]?(t.aTab[l.y][l.x+1]=i,this.bTab[l.y][l.x+1]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1),o.push({x:l.x+1,y:l.y}),n=!1):"M"==t.aTab[l.y][l.x+1]&&(0==this.bTab[l.y][l.x+1].length&&(this.bTab[l.y][l.x+1]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1)),this.status=3)),l.y+1<t.ROWS&&(0==t.aTab[l.y+1][l.x]?(t.aTab[l.y+1][l.x]=i,this.bTab[l.y+1][l.x]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1),o.push({x:l.x,y:l.y+1}),n=!1):"M"==t.aTab[l.y+1][l.x]&&(0==this.bTab[l.y+1][l.x].length&&(this.bTab[l.y+1][l.x]=s(s([],this.bTab[l.y][l.x],!0),[l.y+"_"+l.x],!1)),this.status=3))}3==this.status||(n?this.status=4:this.findShortestRoute(o,i+1))},t.COLUMNS=9,t.ROWS=9,t.NEW_BALLS_COUNT=3,t.SIZE=50,t.BALLS_COLOR_TAB=["red","green","blue"],t.DEL_COUNT=5,function(t,e,i,n){var s,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(a=(o<3?s(a):o>3?s(e,i,a):s(e,i))||a);o>3&&a&&Object.defineProperty(e,i,a)}([e],t.prototype,"deleteBubbles",null),t}();new o})();